<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Master Suite v19.4 - LOCKED DESIGN</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg: #F0F4F8; --white: #FFFFFF; --primary: #1A73E8;
            --A1: #FF5E57; --A2: #FF8D52; --B1: #FFBC52; --B2: #05C46B; --C1: #0FBCE9; --C2: #575fcf;
            --shadow: 0 10px 30px rgba(0,0,0,0.08);
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        html, body { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; font-family: 'Poppins', sans-serif; background: var(--bg); }
        .app-shell { width: 100%; height: 100%; max-width: 480px; margin: 0 auto; display: flex; flex-direction: column; background: var(--bg); position: relative; }
        .screen { display: none; height: 100%; flex-direction: column; animation: fadeIn 0.2s ease; position: absolute; width: 100%; top: 0; left: 0; }
        .active-screen { display: flex; }

        /* HEADER & DASHBOARD */
        .top-bar { padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; }
        .streak-hero { margin: 0 20px 20px; background: linear-gradient(135deg, #FF9F43 0%, #FF6B6B 100%); border-radius: 30px; padding: 25px; color: white; text-align: center; box-shadow: 0 15px 35px rgba(255,107,107,0.3); }
        .streak-num { font-size: 60px; font-weight: 800; line-height: 1; }
        .streak-days { display: flex; justify-content: space-between; margin-top: 20px; background: rgba(255,255,255,0.2); padding: 12px; border-radius: 20px; }
        .day-dot { font-size: 10px; font-weight: 800; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.1); }
        .day-dot.active { background: white; color: #FF6B6B; }

        /* MODE SELECTION */
        .mode-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 18px; padding: 0 20px 25px; }
        .mode-box { background: white; border-radius: 32px; padding: 35px 15px; text-align: center; box-shadow: var(--shadow); cursor: pointer; }
        .mode-box i { font-size: 34px; display: block; margin-bottom: 12px; }

        /* LISTS */
        .content-scroll { flex: 1; overflow-y: auto; padding: 20px; padding-bottom: 100px; }
        .lvl-card { background: white; border-radius: 22px; padding: 18px; margin-bottom: 12px; display: flex; align-items: center; gap: 15px; box-shadow: var(--shadow); }
        .prog-bar-bg { height: 8px; background: #F1F2F6; border-radius: 10px; margin-top: 8px; overflow: hidden; }
        .prog-fill { height: 100%; transition: 0.8s; }

        /* 3D CARD GAME - SABİT ORTA TASARIM */
        .card-zone { flex: 1; display: flex; align-items: center; justify-content: center; padding: 25px; perspective: 1200px; }
        .card-3d { width: 100%; height: 400px; position: relative; transform-style: preserve-3d; transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1); cursor: pointer; }
        .card-3d.flipped { transform: rotateY(180deg); }
        .face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 45px; background: white; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 30px; box-shadow: 0 15px 45px rgba(0,0,0,0.1); }
        .face-back { transform: rotateY(180deg); background: #f8f9fa; }
        .tense-info { margin-top: 15px; font-size: 13px; color: var(--primary); font-weight: 600; background: #e8f0fe; padding: 5px 15px; border-radius: 10px; }

        /* BUTTONS - TAM ORTADA VE SABİT */
        .btn-row { padding: 30px; display: flex; justify-content: center; align-items: center; gap: 50px; background: transparent; }
        .btn-circle { width: 85px; height: 85px; border-radius: 50%; border: none; color: white; font-size: 35px; box-shadow: 0 10px 25px rgba(0,0,0,0.15); cursor: pointer; display: flex; align-items: center; justify-content: center; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

<div class="app-shell">
    <div id="scrMain" class="screen active-screen">
        <div class="top-bar">
            <div style="display:flex; align-items:center; gap:10px;">
                <div style="width:42px; height:42px; background:white; border-radius:50%; display:flex; align-items:center; justify-content:center; box-shadow:var(--shadow); color:var(--primary);"><i class="fa-solid fa-graduation-cap"></i></div>
                <div><b>Master Learner</b><br><small style="color:#808E9B">Hoş geldin!</small></div>
            </div>
            <i class="fa-solid fa-gear" style="font-size:24px; color:#5F6368;" onclick="nav('scrSetts')"></i>
        </div>

        <div class="streak-hero">
            <span class="streak-num">4</span><br><b>Günlük Seri! Bravo Harika Gidiyorsun!</b>
            <div class="streak-days" id="stGrid"></div>
        </div>

        <div style="padding:0 25px 12px; font-weight:800; font-size:12px; color:#808E9B;">EĞİTİM MODLARI</div>
        <div class="mode-grid">
            <div class="mode-box" style="color:#6200EE" onclick="openMod('grammar')"><i class="fa-solid fa-brain"></i><b>GRAMMAR</b></div>
            <div class="mode-box" style="color:#FF9900" onclick="openMod('phrase')"><i class="fa-solid fa-comments"></i><b>PHRASE</b></div>
        </div>
    </div>

    <div id="scrSetts" class="screen">
        <div class="top-bar"><i class="fa-solid fa-chevron-left" onclick="nav('scrMain')"></i><b>YEDEK YÜKLE</b><div></div></div>
        <div class="content-scroll">
            <div class="lvl-card" onclick="document.getElementById('impG').click()" style="cursor:pointer">
                <div style="background:#6200EE; color:white; padding:15px; border-radius:12px;"><i class="fa-solid fa-file-import"></i></div>
                <div style="flex:1"><b>Grammar Yükle (12'li)</b><br><small id="statusG">Bekleniyor...</small></div>
                <input type="file" id="impG" hidden onchange="smartImport(event, 'grammar')">
            </div>
            <div class="lvl-card" onclick="document.getElementById('impP').click()" style="cursor:pointer">
                <div style="background:#FF9900; color:white; padding:15px; border-radius:12px;"><i class="fa-solid fa-file-import"></i></div>
                <div style="flex:1"><b>Phrase Yükle (7'li)</b><br><small id="statusP">Bekleniyor...</small></div>
                <input type="file" id="impP" hidden onchange="smartImport(event, 'phrase')">
            </div>
        </div>
    </div>

    <div id="scrGame" class="screen">
        <div class="top-bar"><i class="fa-solid fa-xmark" onclick="nav('scrSets')"></i><b id="gInfo">SET 1</b><i class="fa-solid fa-volume-high" style="font-size:22px; color:var(--primary)" onclick="speak()"></i></div>
        <div class="card-zone">
            <div class="card-3d" id="card" onclick="this.classList.toggle('flipped')">
                <div class="face"><div id="qTxt" style="font-size:24px; font-weight:800;">Question</div></div>
                <div class="face face-back">
                    <div id="aTxt" style="font-size:22px; font-weight:700; color:var(--primary);">Answer</div>
                    <div id="tTxt" class="tense-info">Tense</div>
                </div>
            </div>
        </div>
        <div class="btn-row">
            <button class="btn-circle" style="background:#FF5E57" onclick="step(false)"><i class="fa-solid fa-xmark"></i></button>
            <button class="btn-circle" style="background:#05C46B" onclick="step(true)"><i class="fa-solid fa-check"></i></button>
        </div>
    </div>

    <div id="scrMod" class="screen"><div class="top-bar"><i class="fa-solid fa-chevron-left" onclick="nav('scrMain')"></i><b id="mTitle"></b><div></div></div><div class="content-scroll" id="lList"></div></div>
    <div id="scrSets" class="screen"><div class="top-bar"><i class="fa-solid fa-chevron-left" onclick="nav('scrMod')"></i><b id="sTitle">SETLER</b><div></div></div><div class="content-scroll" id="setList"></div></div>
</div>

<script>
    let DATA = { mode:'grammar', lvl:'A1', progress:{grammar:{},phrase:{}}, db:{grammar:null,phrase:null} };

    function nav(id){ 
        document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active-screen')); 
        document.getElementById(id).classList.add('active-screen');
        if(id==='scrSetts') updateStatus();
    }

    function updateStatus() {
        document.getElementById('statusG').innerText = (DATA.db.grammar) ? "✅ Yüklendi" : "❌ Yüklenmedi";
        document.getElementById('statusP').innerText = (DATA.db.phrase) ? "✅ Yüklendi" : "❌ Yüklenmedi";
    }

    function smartImport(e, type) {
        const reader = new FileReader();
        reader.onload = (ev) => {
            try {
                const raw = JSON.parse(ev.target.result);
                DATA.db[type] = raw.db ? raw : { db: raw };
                save(); alert("Başarıyla yüklendi!"); location.reload();
            } catch(err) { alert("Dosya hatası!"); }
        }; reader.readAsText(e.target.files[0]);
    }

    function openMod(m){
        DATA.mode = m; document.getElementById('mTitle').innerText = m.toUpperCase();
        const list = document.getElementById('lList'); list.innerHTML = '';
        ['A1','A2','B1','B2','C1','C2'].forEach(l=>{
            const db = DATA.db[m]; const total = (db && db.db && db.db[l]) ? db.db[l].length : 0;
            const done = DATA.progress[m][l] || 0; const pct = total ? Math.min(Math.round((done/total)*100),100) : 0;
            list.innerHTML += `<div class="lvl-card" onclick="openSets('${l}')"><div style="background:var(--${l}); color:white; width:45px; height:45px; border-radius:12px; display:flex; align-items:center; justify-content:center; font-weight:800">${l}</div><div style="flex:1"><div style="display:flex; justify-content:space-between"><b>${l} Seviyesi</b><b>%${pct}</b></div><div class="prog-bar-bg"><div class="prog-fill" style="width:${pct}%; background:var(--${l})"></div></div></div></div>`;
        }); nav('scrMod');
    }

    function openSets(l){
        DATA.lvl = l; const db = DATA.db[DATA.mode]; if(!db || !db.db[l]) return alert("Veri yüklenmemiş!");
        const list = document.getElementById('setList'); list.innerHTML = '';
        db.db[l].forEach((s,i)=>{ list.innerHTML += `<div class="lvl-card" onclick="startPlay(${i})"><b>${s.title}</b></div>`; });
        nav('scrSets');
    }

    let cS=0, cC=0;
    function startPlay(i){ cS=i; cC=0; render(); nav('scrGame'); }

    function render(){
        const item = DATA.db[DATA.mode].db[DATA.lvl][cS].items[cC];
        document.getElementById('card').classList.remove('flipped');
        document.getElementById('qTxt').innerText = item.eng;
        
        let tr = item.tr, tense = "";
        if(tr.includes("(") && tr.includes(")")) {
            tense = tr.substring(tr.indexOf("(")+1, tr.indexOf(")"));
            tr = tr.substring(0, tr.indexOf("(")).trim();
        }
        document.getElementById('aTxt').innerText = tr;
        document.getElementById('tTxt').innerText = tense || "Genel Kalıp";
        document.getElementById('tTxt').style.display = tense ? "block" : "none";
        document.getElementById('gInfo').innerText = "SET " + (cS+1) + " (" + (cC+1) + "/" + DATA.db[DATA.mode].db[DATA.lvl][cS].items.length + ")";
    }

    function step(win){
        cC++; if(cC >= DATA.db[DATA.mode].db[DATA.lvl][cS].items.length){
            DATA.progress[DATA.mode][DATA.lvl] = (DATA.progress[DATA.mode][DATA.lvl]||0)+1;
            save(); alert("Tebrikler, Set bitti!"); openMod(DATA.mode); return;
        } render();
    }

    function speak(){ const u = new SpeechSynthesisUtterance(document.getElementById('qTxt').innerText); u.lang='en-US'; speechSynthesis.speak(u); }
    function save(){ localStorage.setItem('MASTER_V19_4_LOCKED', JSON.stringify(DATA)); }
    function load(){ 
        const local = localStorage.getItem('MASTER_V19_4_LOCKED'); if(local) DATA = JSON.parse(local);
        const g = document.getElementById('stGrid'); const d = ['Pz','Sa','Çr','Pr','Cu','Ct','Pz'];
        g.innerHTML = ''; d.forEach((day, i) => { g.innerHTML += `<div class="day-dot ${i<4?'active':''}">${day}</div>`; });
        updateStatus();
    }
    load();
</script>
</body>
</html>